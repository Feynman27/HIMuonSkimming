#!/bin/zsh

runname()
{
 RUNNUMBER=$1
 FileName=$2

  if [ $RUNNUMBER -eq 192530 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.192530/"
  elif [ $RUNNUMBER -eq 192534 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.192534/"
  elif [ $RUNNUMBER -eq 193211 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193211/"
  elif [ $RUNNUMBER -eq 193270 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193270/"
  elif [ $RUNNUMBER -eq 193291 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193291/"
  elif [ $RUNNUMBER -eq 193294 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193294/"
  elif [ $RUNNUMBER -eq 193295 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193295/"
  elif [ $RUNNUMBER -eq 193321 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193321/"
  elif [ $RUNNUMBER -eq 193402 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193402/"
  elif [ $RUNNUMBER -eq 193403 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193403/"
  elif [ $RUNNUMBER -eq 193411 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193411/"
  elif [ $RUNNUMBER -eq 193412 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193412/"
  elif [ $RUNNUMBER -eq 193447 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193447/"
  elif [ $RUNNUMBER -eq  193463 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193463/"
  elif [ $RUNNUMBER -eq  193481 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193481/"
  elif [ $RUNNUMBER -eq  193491 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193491/"
  elif [ $RUNNUMBER -eq  193492 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193492/"
  elif [ $RUNNUMBER -eq  193493 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193493/"
  elif [ $RUNNUMBER -eq  193494 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193494/"
  elif [ $RUNNUMBER -eq  193546 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193546/"
  elif [ $RUNNUMBER -eq  193599 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193599/"
  elif [ $RUNNUMBER -eq  193604 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193604/"
  elif [ $RUNNUMBER -eq  193558 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193558/"
  elif [ $RUNNUMBER -eq  193662 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193662/"
    elif [ $RUNNUMBER -eq  193655 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193655/"
    elif [ $RUNNUMBER -eq  193641 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193641/"
  elif [ $RUNNUMBER -eq  193679 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193679/"
  elif [ $RUNNUMBER -eq  193687 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193687/"

  elif [ $RUNNUMBER -eq  193718 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193718/"
  elif [ $RUNNUMBER -eq  193795 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193795/"

  elif [ $RUNNUMBER -eq 193823 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193823/"
  elif [ $RUNNUMBER -eq 193825 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193825/"
  elif [ $RUNNUMBER -eq 193826 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193826/"
  elif [ $RUNNUMBER -eq 193834 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193834/"
  elif [ $RUNNUMBER -eq 193890 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.193890/"
  elif [ $RUNNUMBER -eq 194017 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194017/"
  elif [ $RUNNUMBER -eq 194060 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194060/"
  elif [ $RUNNUMBER -eq 194061 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194061/"
  elif [ $RUNNUMBER -eq 194079 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194079/"
  elif [ $RUNNUMBER -eq 194121 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194121/"
  elif [ $RUNNUMBER -eq 194160 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194160/"
  elif [ $RUNNUMBER -eq 194163 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194163/"
  elif [ $RUNNUMBER -eq 194179 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194179/"
  elif [ $RUNNUMBER -eq 194192 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194192/"
  elif [ $RUNNUMBER -eq 194193 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194193/"
  elif [ $RUNNUMBER -eq 194287 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194287/"
  elif [ $RUNNUMBER -eq 194370 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194370/"
  elif [ $RUNNUMBER -eq 194374 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194374/"
  elif [ $RUNNUMBER -eq 194382 ]
  then
    File="user.tbalestr.MuonJetsHardProbes.D3PD.2013.08.13.v01.194382/"
  fi

  echo "    --inDS $File \\">> $FileName
  echo "dq2-ls $File ">> check.sh
}


Filename=SubmitMuonHardProbesD3PD.sh 
spreadSheetName=MuonHardProbesD3PDSlimmed.csv

if [ -e $Filename ]
then
  rm $Filename
fi

if [ -e $spreadSheetName ]
then
  rm $spreadSheetName
fi

if [ -e dq_get_all.sh ]
then
  rm dq_get_all.sh
fi

if [ -e check_site.sh  ]
then
  rm check_site.sh
fi


if [ -e check.sh  ]
then
  rm check.sh
fi

aa="my"$1
if test $aa = "myclean"
then
   exit 0
fi



today=`date +%Y.%m.%d.`
prefix="user.tbalestr.MuonJetsHardProbes.D3PD.Slimmed."

RUNNO=1
#for RUN in 193211  
#all 47 runs
for RUN in 193321 193295 193294 193291 193270 193546 193463 193447 193412 193411 193403 193402 193604 193641 193687 193718 193823 194060 194121 194179 194192 194193 194382 194374 194370 194287 194163 194160 194079 194061 194017 193834 193826 193825 193599 193558 193662 193679 193890 193481 193491 193492 193493 193494 193655 193795 193211 
#for RUN in 193294 193447 193412 194121 194382   
do


  
  
  OUTDS=$prefix$today"v01."
#  if [ $RUN -gt 193447 ] #not produced yet
#  then
#    continue
#  fi

  echo $RUNNO "  " $RUN
  RUNNO=`expr $RUNNO + 1`

  echo "prun --exec \"echo %IN > input.txt; './SlimMain.exe' \"  \\" >>$Filename
  echo "    --outputs HISingleMuonHP.root \\" >>$Filename
  echo "    --athenaTag 17.2.10.5 \\">>$Filename
  echo "    --match '*skimmed*' \\">>$Filename
  runname $RUN $Filename
  echo "    --outDS $OUTDS$RUN \\">>$Filename
  echo "    --excludeFile .svn,Log.txt,make_submit_New.sh,filter.sh,check.sh,*.o,*.h,*.C $Filename \\">>$Filename
  echo "    --extFile SlimMain.exe ,input.txt \\">>$Filename
#  echo "    --noCompile \\">>$Filename
  echo "    --noBuild \\">>$Filename
  #echo "    --nGBPerJob=MAX \\">>$Filename
  echo "    --nGBPerJob 10 \\">>$Filename
  echo "    --nFilesPerJob 10 \\">>$Filename
#  echo "    --maxFileSize 10000000 \\">>$Filename
  echo "    --mergeOutput">>$Filename
  echo "echo \"$RUN : \$? \" >>Log.txt">>$Filename
  echo "echo">>$Filename
  echo "echo">>$Filename
  echo -e "\n\n">>$Filename

  echo "dq2-get -f \"*root*\" $OUTDS$RUN/" >>dq_get_all.sh
  echo "$OUTDS$RUN/,">>$spreadSheetName

done

